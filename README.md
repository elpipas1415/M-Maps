# Impactor MVP — Educational

This project is an educational meteor impact simulator that integrates a **Python/FastAPI** backend and a **HTML/JavaScript** frontend with **Leaflet** and **Three.js**. It was designed for the *NASA Space Apps Challenge* as a learning tool that connects basic asteroid data with simple physics calculations and practical mitigation recommendations.

> Important: All scenarios and results generated by this application are hypothetical and based on simplified models. They do not constitute a real prediction or official notice. For official information about asteroid risks, consult space agencies such as NASA and USGS.

## Quick Start

Run locally in minutes:

- Backend
  - `cd backend`
  - `pip install -r requirements.txt`
  - `python -m uvicorn main:app --reload`
  - Check health: open `http://127.0.0.1:8000/health` (should return `ok`).
- Frontend
  - `cd frontend`
  - `python -m http.server 8080`
  - Open `http://127.0.0.1:8080/?env=dev`
- Configuration
  - Edit `frontend/config.js` for local dev (`apiBase` → `http://127.0.0.1:8000`).
  - For production, set `frontend/config.prod.js` and open with `?env=prod`.

## Structure

- `backend/`: FastAPI server (`main.py`) and dependencies in `requirements.txt`.
- `frontend/`: web interface with:
  - `index.html`: 2D simulator with map, controls, and educational results.
  - `three.html`: simplified 3D visualization of the trajectory and impact using Three.js.
  - `style.css`: additional styles (optional).
- `data/`: sample data (`asteroids.json`).
- `README.md`: this document.

## Requirements

- Python 3.10 or later.
- pip (Python package manager).
- Internet connection to load map tiles (OpenStreetMap) and libraries from CDN.

## Configuration

- `frontend/config.js`: configuración de desarrollo local.
  - `apiBase`: normalmente `http://127.0.0.1:8000`.
  - `maptiler.key` y `geocoding.key` (OpenCage): claves públicas del cliente.
- `frontend/config.prod.js`: configuración de producción.
  - `apiBase`: URL pública del backend (Render/Railway/Fly.io).
  - Claves reales de `maptiler.key` y `geocoding.key` para producción.
- Selector de entorno:
  - `?env=dev` fuerza desarrollo.
  - `?env=prod` fuerza producción.
  - Sin parámetro: usa producción automáticamente si no estás en `localhost/127.0.0.1`.

## Installation and run

1. In a terminal, go to the `backend/` folder and install dependencies:

   ```bash
   pip install -r requirements.txt
   ```

2. Run the server with Uvicorn:

   ```bash
   python -m uvicorn main:app --reload
   ```

   The backend listens by default on `http://127.0.0.1:8000`. If you want a different host or port, pass `--host` and `--port` to uvicorn.

3. Open the web interface. You can:

   - Open `frontend/index.html` directly in your browser (double click) if your browser allows requests to `127.0.0.1:8000`.
   - Or serve the frontend files with a simple Python server:

     ```bash
     cd frontend
     python -m http.server 8080
     ```

     Then open `http://127.0.0.1:8080/?env=dev` in your browser.

4. Optional: download/update local JS libs (if needed)

   ```powershell
   cd frontend
   ./download_libs.ps1
   ```

5. Health check and configuration

   - Backend health: `GET http://127.0.0.1:8000/health` should return status `ok`.
   - If the map tiles fail, verify your `MAPTILER_KEY` in `config.js`.
   - If geocoding fails (401/404), verify `OPENCAGE_KEY` in `config.js` or set `ENABLE_OPENCAGE=false` in `index.html`.

4. On the page:

   - Click the map to select an impact point.
   - Adjust controls: diameter, density, velocity, angle, delta-v, warning time, composition, rotation, and probability.
   - Click “Simulate impact”. You will see results with mass, energy (in Joules and megatons TNT), crater size, evacuation recommendations, deflection strategies, alert messages, and notes explaining why each parameter matters.
   - Click “View 3D simulation” to open a new window that shows the simplified asteroid trajectory, Earth, the impact point, and the crater in 3D space.

## Archivos clave

- **backend/main.py**: Define los modelos de datos, cálculos físicos
  (masa, energía, cráter), estimación de incertidumbre y lógica
  educativa (clasificación por tamaño, niveles de riesgo, radio de
  evacuación, recomendaciones de defensa, mensajes de alerta y notas
  críticas). Expone el endpoint `/simulate` y un endpoint de salud
  `/health`.

- **frontend/index.html**: Construye la interfaz con Leaflet para el
  mapa, controles de entrada, botón para simular y panel de
  resultados. Llama al backend para obtener los resultados y
  dibuja un círculo del cráter en el mapa. Además, almacena el
  resultado en `localStorage` para que la vista 3D lo use.

  En esta versión extendida incluye también:

  - **Infografías educativas** incrustadas que explican los tipos de asteroides (rocosos, metálicos y porosos) y los diferentes efectos ambientales de un impacto (radiación térmica, sacudidas sísmicas, onda de choque, tsunami y eyección de material). Estas imágenes ofrecen una referencia visual para el público general.
  - Una sección de **fuentes de datos** que resume los recursos abiertos de la NASA y del USGS. La API NEO de la NASA ofrece parámetros orbitales, tamaños y fechas de aproximación para asteroides y cometas; con una clave gratuita se pueden modelar trayectorias, calcular probabilidades y simular estrategias de deflexión【535898766925335†screenshot】. El catálogo de terremotos NEIC del USGS proporciona magnitudes y ubicaciones globales para correlacionar la energía de impacto con magnitudes equivalentes. Los modelos digitales de elevación del USGS permiten considerar la topografía y batimetría al evaluar tsunamis o cráteres【535898766925335†screenshot】.

  - Descripciones más detalladas de las **herramientas de defensa**, mostrando no solo el nombre de la estrategia (impactador cinético, tractor gravitacional, deflexión nuclear, evacuación) sino también un breve resumen de cómo funciona y bajo qué condiciones es efectiva.

  - Contextual alerts that vary depending on biome, estimated seismic magnitude, and tsunami risk; this makes evacuation and preparedness recommendations more specific.

- **frontend/three.html**: Uses Three.js to render Earth, a simplified linear trajectory toward the impact point, and a marker at the impact site. It reads the last simulated result from `localStorage`.

## Deployment (Production)

- Backend (FastAPI) — Render
  - Connect your GitHub repo and create a “Web Service” pointing to `backend/`.
  - Build: auto-detected from `requirements.txt`.
  - Start command: `uvicorn main:app --host 0.0.0.0 --port $PORT`.
  - Copy the public URL (e.g. `https://your-backend.onrender.com`) into `frontend/config.prod.js > apiBase`.

- Frontend (static) — Netlify/Vercel
  - Deploy the `frontend/` folder as a static site.
  - The app will read `config.prod.js` in production or with `?env=prod`.
  - Open `https://<your-site>/?env=prod` to verify.

- Notes
  - Keys in the browser are public; restrict by domain if the provider allows.
  - CORS on the backend must allow your frontend domain.

## Publish to GitHub

From the project root:

```bash
git init
git add .
git commit -m "Initial public version"
git branch -M main
git remote add origin https://github.com/<user>/<repo>.git
git push -u origin main
```

Ensure `.gitignore` excludes `.env`, `__pycache__/`, and build artifacts.

## Final notes

This project was designed to teach basic concepts of impact physics, planetary risks, and mitigation strategies. It can be customized to include real data (NASA NEO API, USGS) or expanded with more sophisticated models. However, for clarity and performance in a hackathon context, intentional simplifications are kept.
